(self.modernJsonp=self.modernJsonp||[]).push([["52176"],{576140:function(e,t,r){r.d(t,{q:()=>p});var a=r(667294),n=r(581722),o=r(825332),s=r(400267),l=r(821342),i=r(274320),u=r(378888),c=r(469817),d=r(76086),m=r(261228);let p=()=>{let{checkExperiment:e}=(0,i.r)(),t=e("ap_dweb_nux_in_sync_closeup_request",{dangerouslySkipActivation:!0}).group,r="control_baseline"===t||"enabled_closeup"===t,p=e("ap_dweb_nux_revamp_v3_iteration",{dangerouslySkipActivation:!0}).anyEnabled,_=e("activation_foundation_dweb_autofollow_v2",{dangerouslySkipActivation:!0}).anyEnabled,f=(0,o.TH)(),g=(0,l.Z)(),E=(0,n.I0)(),{selectedUseCases:y,selectedPins:h}=(0,d.u)(),C=(0,c.rQ)(y,h);return(0,a.useCallback)(()=>{let e=g.isAuth&&g.firstHomeFeedRequestAfterNux,t=(0,s.Z)({viewerIsPartner:g.isAuth&&g.isPartner,inNux:(e&&E((0,m.H5)(!1)),e),staticFeed:!!(f&&(f.pathname.includes("pwt_performance_testing")||void 0!==(0,u.mB)(f.search).pwt_performance_testing)),inNewsHub:f?.pathname.includes("news_hub")??!1});return{name:"UserHomefeedResource",options:(r||p||_)&&C.length>0?{...t,nux_signals_map:C}:t}},[E,g,f,r,p,_,C])}},449029:function(e,t,r){r.d(t,{_:()=>l,p:()=>i}),r(281098);var a=r(667294),n=r(729434),o=r(785893);let{Provider:s,get:l}=(0,n.Z)("VisualShopContext");function i({children:e}){let[t,r]=(0,a.useState)({}),[n,l]=(0,a.useState)({}),i=(0,a.useRef)(0),u=(0,a.useRef)("");return(0,o.jsx)(s,{value:{cachedOneBarModules:t,setCachedOneBarModules:r,cachedDescriptorModules:n,setCachedDescriptorModules:l,imageContainerScrollTop:i,imageContainerScrollTopForPinId:u},children:e})}},390843:function(e,t,r){r.d(t,{aX:()=>m,nK:()=>p,ou:()=>u}),r(281098);var a=r(667294),n=r(616550),o=r(825332),s=r(729434),l=r(785893);let{Provider:i,get:u}=(0,s.Z)("HistoryStackContext",{previous:[],current:null,forward:[]}),c=e=>e&&e.pathname?e.pathname+(e.search||""):"";function d(e,t){let r={action:t.type,location:t.location,match:t.match};if(t.location===e.current?.location)return e;switch(t.type){case"POP":if(e.forward.length>0&&c(e.forward[0].location)===c(r.location))return{...e,forward:e.forward.slice(1),current:{...e.forward[0],action:t.type},previous:e.current?[...e.previous,{action:e.current.action,location:e.current.location,match:e.current.match}]:e.previous};return{...e,forward:e.current?[{action:e.current.action,location:e.current.location,match:e.current.match},...e.forward]:e.forward,current:{...e.previous.slice(-1)[0],action:t.type},previous:e.previous.slice(0,-1)};case"PUSH":return{...e,forward:e.forward.length>0?[]:e.forward,current:r,previous:e.current?[...e.previous,{action:e.current.action,location:e.current.location,match:e.current.match}]:e.previous};case"REPLACE":return{...e,current:r};default:return e}}function m(){let{current:e,previous:t}=u();return(0,a.useMemo)(()=>e?t.concat(e):t,[e,t])}function p({children:e}){let t=(0,n.k6)(),r=(0,o.TH)(),s=(0,n.$B)(),u={forward:[],current:{action:t.action,location:r,match:s},previous:[]},[c,m]=(0,a.useReducer)(d,u),p=(0,a.useRef)(r);if(p.current!==r){let{action:e}=t;m({type:e,location:r,match:s}),p.current=r}return(0,l.jsx)(i,{value:c,children:e})}},399573:function(e,t,r){r.d(t,{Z:()=>a});function a(e){return function e(t,r){let a;if(null==t||"object"!=typeof t&&"function"!=typeof t)return t;let n=r.find(e=>e.value===t);if(n)return n.result;let o=Object.prototype.toString.call(t);switch(o){case"[object Array]":a=Array(t.length);break;case"[object Set]":a=new Set;break;case"[object Object]":case"[object Arguments]":a={};break;case"[object Map]":a=new Map;break;default:return t}let s=[...r,{value:t,result:a}];switch(o){case"[object Array]":t.forEach((t,r)=>{a[r]=e(t,s)});break;case"[object Set]":t.forEach(t=>{a.add(e(t,s))});break;case"[object Object]":case"[object Arguments]":Object.entries(t).forEach(([t,r])=>{a[t]=e(r,s)});break;case"[object Map]":t.forEach((t,r)=>{a.set(r,e(t,s))})}return a}(e,[])}},289032:function(e,t,r){r.d(t,{Z:()=>a});function a(e,t,r){let a,n,o,s=!!r?.leading,l=r?.trailing!==!1,i=r?.maxWait?Math.max(r.maxWait,t):void 0,u=null,c=0;function d(t){let r=a;return a=void 0,c=t,r&&(n=e(...r)),n}function m(e){let r=e-(o??0),a=e-c;return void 0===o||r>=t||r<0||void 0!==i&&a>=i}function p(){let e=Date.now();m(e)?(u=null,l&&a)?d(e):a=void 0:u=setTimeout(p,function(e){let r=e-(o??0),a=e-c,n=t-r;return void 0!==i?Math.min(n,i-a):n}(e))}function _(){null!==u&&clearTimeout(u),u=setTimeout(p,t)}function f(...e){let r=Date.now(),l=m(r);if(a=e,o=r,l){if(null===u)return c=r,u=setTimeout(p,t),s?d(r):n;else if(void 0!==i)return _(),d(r)}return null===u&&_(),n}return f.flush=function(){if(null!==u&&a){let e=Date.now();return clearTimeout(u),u=null,d(e)}return n},f.cancel=function(){null!==u&&clearTimeout(u),c=0,a=void 0,o=void 0,u=null},f}},707079:function(e,t,r){r.d(t,{F_:()=>s,MA:()=>l,ZP:()=>n,y8:()=>o});var a=r(729434);class n{constructor(){var e,t,r;t={},(e="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e="pending","string"))?r:r+"")in this?Object.defineProperty(this,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):this[e]=t}add(e,t,r){r&&(this.pending[e]={...this.pending[e]??{},[t]:r},r.finally?.(()=>this.remove(e,t)))}remove(e,t){this.pending[e]?.[t]&&(delete this.pending[e][t],0===Object.keys(this.pending[e]).length&&delete this.pending[e])}get(e,t){return this.pending[e]?.[t]??null}}let o=new n,{Provider:s,getMaybe:l}=(0,a.Z)("PendingFetches")},791948:function(e,t,r){r.d(t,{UZ:()=>p,Z8:()=>_,my:()=>f,vL:()=>E,w1:()=>g}),r(281098);var a=r(667294),n=r(581722),o=r(575108),s=r(729434),l=r(72918),i=r(785893);function u(e,t,r){let a=[...t[e][r.payload.name]??[],r.payload.handler],n={...t};return n[e]={...t[e],[r.payload.name]:a},n}function c(e,t,r){if(!t[e][r.payload.name])return t;let a=t[e][r.payload.name].filter(e=>e!==r.payload.handler),n={...t};return n[e]={...t[e],[r.payload.name]:a},n}let{Provider:d,get:m}=(0,s.Z)("ResourceContext");function p({children:e,resourceCreator:t}){let[{listeners:r,moreListeners:n},s]=(0,a.useReducer)((e,t)=>{switch(t.type){case"addListener":return u("listeners",e,t);case"addMoreListener":return u("moreListeners",e,t);case"removeListener":return c("listeners",e,t);case"removeMoreListener":return c("moreListeners",e,t);default:return e}},{listeners:{},moreListeners:{}});o.Z.fetchCompleteCallback=({resource:e,options:t,response:a,normalizedResponse:n,refresh:o,resourceSchema:s})=>{r[e]&&r[e].forEach(r=>r({isRefresh:o,normalizedResponse:n,options:t,schema:s,resource:e,response:a}))},o.Z.fetchMoreCompleteCallback=({resource:e,options:t,response:r,normalizedResponse:a,refresh:o,resourceSchema:s})=>{n[e]&&n[e].forEach(n=>n({isRefresh:o,normalizedResponse:a,options:t,schema:s,resource:e,response:r}))};let l=(0,a.useMemo)(()=>({listenerDispatch:s,resourceCreator:t}),[t]);return(0,i.jsx)(d,{value:l,children:e})}function _(e,t){let{listenerDispatch:r}=m();(0,a.useEffect)(()=>(r({type:"addListener",payload:{name:e,handler:t}}),()=>{r({type:"removeListener",payload:{name:e,handler:t}})}),[r,e,t])}function f(e,t){let{listenerDispatch:r}=m();(0,a.useEffect)(()=>(r({type:"addMoreListener",payload:{name:e,handler:t}}),()=>{r({type:"removeMoreListener",payload:{name:e,handler:t}})}))}function g(){let e=(0,n.I0)();return(0,a.useCallback)((t,r)=>e((0,l.jB)(t,r)),[e])}function E(){return m().resourceCreator}},536652:function(e,t,r){r.d(t,{U:()=>d,b:()=>m});var a=r(575108),n=r(399573),o=r(440568),s=r(849233),l=r(72918),i=r(82347),u=r(954300);function c({addSuspenseResourceSSRData:e,fetchOptions:t,resource:r,resourceCreator:d,retry:m}){return async(_,f)=>{let{bookmark:g,headers:E,options:y,refresh:h,schema:C}=t,b=(0,o.Z)(y);if(f().resources?.[r]?.[b]?.fetching&&!m)return Promise.resolve();let T=m?m.bookmark:g,v=(0,n.Z)(y),A=T?{...v,bookmarks:[T]}:v;_((0,l.LQ)(r,y,!0));try{let n,o,f=d??a.Z.create,b=await f(r,A).callGet(void 0,E);e&&p(b)&&e(r,A,b),p(b)||(n=b.bookmarks?.[0]);let{data:T}=b.resource_response,{normalizedResponse:v,resourceSchema:M}=(0,u.f)({data:T,opts:{bookmark:g,options:y,schema:C},resource:r});if(p(b)){n=b.resource_response.bookmark??"";let e=(0,i.Z)(b);v=e.normalizedResponse,M=e.schema,o=e.response}else o=b;if(Array.isArray(T)&&0===T.length&&n&&n!==s.qx){let e=m?m.count:0;if(!(e>=s.s9))return _(c({resource:r,fetchOptions:t,retry:{count:e+1,bookmark:n},resourceCreator:d}))}o&&(g?(_((0,l.Dm)(r,y,o,v,M)),a.Z.fetchMoreCompleteCallback&&a.Z.fetchMoreCompleteCallback({resource:r,options:y,response:o,normalizedResponse:v,refresh:h,resourceSchema:M})):(_((0,l.Sr)(r,y,o,v,h,M)),a.Z.fetchCompleteCallback&&a.Z.fetchCompleteCallback({resource:r,options:y,response:o,normalizedResponse:v,refresh:h,resourceSchema:M})))}catch(t){if(e){let a=t.http_status??500;e(r,y,{resource:{name:r,options:y},resource_response:{data:null,error:t,http_status:a,status:"failure"}})}_((0,l.Tl)(r,y,t))}}}let d=(e,{bookmark:t,headers:r,options:a,schema:n},o,s)=>c({resource:e,fetchOptions:{bookmark:t,headers:r,options:a,refresh:!1,schema:n},resourceCreator:o,addSuspenseResourceSSRData:s}),m=(e,{headers:t,options:r,schema:a},n)=>c({resource:e,fetchOptions:{headers:t,options:r,refresh:!0,schema:a},resourceCreator:n});function p(e){return"resource"in e}},72918:function(e,t,r){r.d(t,{Dm:()=>u,LQ:()=>s,Sr:()=>i,Tl:()=>l,XM:()=>o,jB:()=>c});var a=r(35831),n=r(23534);function o(e,t,r,n){return{type:a.AF,payload:{resource:e,options:t,response:r,normalizedResponse:n}}}function s(e,t,r){return{type:a.KK,payload:{resource:e,options:t,isFetching:r}}}let l=(e,t,r)=>({type:a.cR,payload:{resource:e,options:t,error:r}});function i(e,t,r,o,s,l){return{type:a.zP,payload:{isRefresh:s,normalizedResponse:o,options:t,resource:e,response:r,schema:l},meta:{[n.s]:!0}}}function u(e,t,r,n,o){return{type:a.aW,payload:{resource:e,options:t,response:r,normalizedResponse:n,schema:o}}}function c(e,t){return{type:a.se,payload:{resource:e,optionsOrOptionsKey:t}}}},82347:function(e,t,r){r.d(t,{Z:()=>s});var a=r(782677),n=r(24315),o=r(954300);function s(e){let{resource:t,resource_response:r}=e,{name:s,options:l}=t,i=(0,n.Z)(r),{data:u,error:c}=r,d=(0,o.J)(s,{options:l});return{error:c,isRefresh:!1,normalizedResponse:d&&u?(0,a.Fv)(u,d):null,options:l,resource:s,response:{auxData:i,bookmarks:r.bookmark?[r.bookmark]:void 0,resource_response:{data:u,error:c}},schema:d}}},943257:function(e,t,r){r.d(t,{Z:()=>m});var a=r(667294),n=r(581722),o=r(825332),s=r(440568),l=r(15667),i=r(536652),u=r(849233),c=r(707079),d=r(791948);function m(e,t,r){let{enabledRouteRefresh:m,headers:p,name:_,noCache:f,options:g,schema:E}=e,y=(0,c.MA)(),h=(0,d.vL)(),C=(0,n.I0)(),b=(0,s.Z)(g),T=(0,a.useRef)(void 0),v=(0,o.ur)(),A=(0,a.useRef)(void 0),M=e=>e[_]?.[b],w=(0,n.v9)(({resources:e})=>M(e)?.data),R=(0,n.v9)(({resources:e})=>M(e)?.error),G=!!R||void 0!==w,k=(0,n.v9)(({resources:e})=>!!M(e)?.fetching),U=(0,n.v9)(({resources:e})=>M(e)?.nextBookmark),D=G&&!k&&U===u.qx,O=!!(G&&m&&"POP"!==v&&!t),[P,N]=(0,a.useState)(O),S=P;(0,n.wU)(w,A.current)||(P&&(A.current||!O)&&(S=!1,N(!1)),A.current=w);let Z=(0,a.useCallback)(e=>{let t=C((0,i.U)(_,{options:g,schema:E,bookmark:e,headers:p},h,void 0));e||y?.add(_,b,t)},[C,_,b,E,p]),L=(0,a.useCallback)(()=>{let e=C((0,i.b)(_,{options:g,schema:E,headers:p},h));y?.add(_,b,e)},[C,_,b,E,p]),I=(0,a.useCallback)(()=>{t||(L(),N(!0))},[t,L]),j=(0,a.useCallback)(()=>{!U||D||k||t||Z(U)},[t,Z,D,k,U]),{isBot:F}=(0,l.B)(),H=(0,a.useCallback)(()=>{if(!(k||y?.get(_,b))&&!t&&T.current!==b){let e=void 0===T.current;T.current=b,!G||r&&e&&R&&(({httpStatus:e})=>!e||e>=500)(R)?Z():(!F&&f||O)&&L()}},[r,Z,L,t,R,F,k,G,O,_,f,b,y]),x=(0,a.useMemo)(()=>({name:_,optionsKey:b}),[_,b]);return(0,a.useMemo)(()=>({fetchResource:H,ref:x,refresh:I,fetchMore:j,isFetching:k,isLoaded:G,isRefreshing:S}),[j,H,k,G,x,S,I])}(0,r(512395).kr)()},886981:function(e,t,r){r.d(t,{Z:()=>i});var a=r(667294),n=r(581722),o=r(440568),s=r(849233),l=r(943257);function i(e){let{enabledRouteRefresh:t,headers:r,name:i,noCache:u,options:c,schema:d}=e??{name:s.fY,options:null},m=(0,o.Z)(c),p=e=>e[i]?.[m],_=(0,n.v9)(({resources:e})=>p(e)?.nextBookmark),f=(0,n.v9)(({resources:e})=>p(e)?.data),g=(0,n.v9)(({resources:e})=>p(e)?.auxData),E=(0,n.v9)(({resources:e})=>p(e)?.error),{fetchResource:y,fetchMore:h,isFetching:C,isLoaded:b,isRefreshing:T,refresh:v}=(0,l.Z)({enabledRouteRefresh:t,headers:r,name:i,noCache:u,options:c,schema:d},!e,!0),A=b&&!C&&_===s.qx;return(0,a.useEffect)(()=>{y()}),(0,a.useMemo)(()=>({auxData:g,data:f,error:E,fetchMore:h,isAtEnd:A,isFetching:C,isLoaded:b,isRefreshing:T,nextBookmark:_,refresh:v}),[g,f,E,h,A,C,b,T,_,v])}},105433:function(e,t,r){r.d(t,{pb:()=>h,nf:()=>C,lV:()=>b}),r(281098);var a=r(667294),n=r(581722),o=r(441143),s=r.n(o),l=r(575108),i=r(729434),u=r(686319),c=r(791948),d=r(503246),m=r(991384);let p={feature_map:Object.freeze({})},_=(e,t)=>{let r={...(0,m.Z)(e,t),...t.reaction_counts?{reaction_counts:t.reaction_counts}:Object.freeze({}),...t.tags?{tags:t.tags}:Object.freeze({}),...t.tagged_users?{tagged_users:t.tagged_users}:Object.freeze({})};return(0,d.ZP)(e,r)?e:r},f=(e,t)=>{if(e=e||p,"FETCH_COMPLETE"===t.type){let{payload:{resource:r}}=t,{data:a}=t.payload.response.resource_response;if("AggregatedCommentFeedResource"===r||"AggregatedCommentReplyFeedResource"===r||"DidItCommentsResource"===r){let t=(a||[]).reduce((t,r)=>(t[r.id]=_(e[r.id],r),t),{});return{...e,...t}}if("UnifiedCommentsResource"===r&&a&&a.length>0){let t=a.filter(e=>"aggregatedcomment"===e.type).reduce((t,r)=>(t[r.id]=_(e[r.id],r),t),{});return{...e,...t}}if("UnifiedCommentsPreviewResource"===r&&a&&a.length>0){let t=a.map(e=>e.aggregated_comment).reduce((t,r)=>(r&&(t[r.id]=_(e[r.id],r)),t),{}),r=a.map(e=>e.creator_reply).reduce((t,r)=>(r&&r.id&&(t[r.id]=_(e[r.id],r)),t),{});return{...e,...t,...r}}if("AggregatedCommentFeaturesResource"===r&&a&&Object.keys(a).length>0)return{...e,feature_map:a}}else if("AGGREGATED_COMMENT_CREATED"===t.type){let{payload:{aggregatedComment:r}}=t;return r.id?{...e,[r.id]:r}:e}else if("AGGREGATED_COMMENT_DELETED"===t.type||"AGGREGATED_COMMENT_HIDDEN"===t.type){let{payload:{aggregatedCommentId:r}}=t,a={...e};return delete a[r],a}else if("AGGREGATED_COMMENT_HIDDEN_FOR_USER"===t.type){let{payload:{userId:r}}=t;return Object.fromEntries(Object.entries(e).filter(e=>e[1].user?.id!==r))}else if("AGGREGATED_COMMENT_UPDATED"===t.type){let{payload:{data:r}}=t;return{...e,[r.id]:_(e?.[r.id],r)}}else if("AGGREGATED_COMMENT_LIKE_TOGGLED"===t.type){let{payload:{data:r}}=t,a=e?.[r.id],n=a?.reaction_counts[1]||0,o={1:r.reaction_by_me?n+1:n-1},s={...a,reaction_by_me:r.reaction_by_me,reaction_counts:o};return{...e,[r.id]:s}}else if("AGGREGATED_COMMENT_HELPFUL_TOGGLED"===t.type){let{payload:{data:r}}=t,a=e?.[r.id],n=a?.helpful_count||0,o=r.marked_helpful_by_me?n+1:n-1,s={...a,marked_helpful_by_me:r.marked_helpful_by_me,helpful_count:o};return{...e,[r.id]:s}}else if("AGGREGATED_COMMENT_HIGHLIGHT_TOGGLED"===t.type){let{payload:{data:r}}=t,a={...e?.[r.aggregated_comment_id],highlighted_by_pin_owner:r.is_highlighted};return{...e,[r.aggregated_comment_id]:a}}else if("AGGREGATED_COMMENT_FEATURES_UPDATED"===t.type){let{payload:{data:{featureMap:r}}}=t;return{...e,feature_map:{...e?.feature_map,...r}}}else if("UPDATE_AGGREGATED_COMMENT_COMMENT_COUNT"===t.type){let{payload:{increment:r,id:a}}=t,n=e?.[a];if(!n)return e;let o={...n,comment_count:n.comment_count+r};return{...e,[a]:o}}else if("DELETE_COMMENT_MENTION"===t.type){let{payload:{aggregatedCommentId:r,tagged_users:a}}=t,n={...e?.[r],tagged_users:a};return{...e,[r]:n}}else if("GET_COMMENT_TRANSLATION"===t.type){let{payload:{aggregatedCommentId:r,translatedText:a}}=t,n={...e?.[r],translatedText:a};return{...e,[r]:n}}return e};var g=r(785893);let{Provider:E,get:y}=(0,i.Z)("AggregatedComments");function h({children:e}){let t=(0,n.v9)(({resources:e})=>e?.UnifiedCommentsResource),r=p;t&&Object.values(t).forEach(e=>{let t=e.data?.filter(e=>"aggregatedcomment"===e.type),a=t?.reduce((e,t)=>(e[t.id]=_(r[t.id],t),e),{});r={...r,...a}});let[o,s]=(0,a.useReducer)(f,r),l=e=>{s({type:"FETCH_COMPLETE",payload:e})};(0,c.Z8)("AggregatedCommentFeaturesResource",l),(0,c.my)("AggregatedCommentFeaturesResource",l),(0,c.Z8)("AggregatedCommentFeedResource",l),(0,c.my)("AggregatedCommentFeedResource",l),(0,c.Z8)("AggregatedCommentReplyFeedResource",l),(0,c.my)("AggregatedCommentReplyFeedResource",l),(0,c.Z8)("DidItCommentsResource",l),(0,c.my)("DidItCommentsResource",l),(0,c.Z8)("UnifiedCommentsPreviewResource",l),(0,c.my)("UnifiedCommentsPreviewResource",l),(0,c.Z8)("UnifiedCommentsResource",l),(0,c.my)("UnifiedCommentsResource",l);let i=(0,a.useMemo)(()=>({aggregatedComments:o,dispatch:s}),[o,s]);return(0,g.jsx)(E,{value:i,children:e})}function C(){let{dispatch:e}=y();return(0,a.useMemo)(()=>({aggregatedCommentCreated(t,r){e({type:"AGGREGATED_COMMENT_CREATED",payload:{parentId:t,aggregatedComment:r}})},aggregatedCommentDeleted:(t,r)=>{e({type:"AGGREGATED_COMMENT_DELETED",payload:{parentId:t,aggregatedCommentId:r}})},aggregatedCommentHidden:t=>{e({type:"AGGREGATED_COMMENT_HIDDEN",payload:{aggregatedCommentId:t}})},aggregatedCommentsHiddenForUser:t=>{e({type:"AGGREGATED_COMMENT_HIDDEN_FOR_USER",payload:{userId:t}})},flagAggregatedComment:async({isAggregatedComment:e=!0,commentId:t,reason:r,detailedReasons:a})=>{let n=e?`/v3/aggregated_comments/${t}/flag/`:`/v3/did_it/${t}/flag/`;return(0,u.Z)({url:n,method:"PUT",data:{commentId:t,reason:r,detailedReasons:a}})},deleteCommentMention:async t=>{let{resource_response:r}=await (0,u.Z)({url:`/v3/aggregated_comments/${t}/mentions/`,method:"DELETE",data:{fields:["aggregatedcomment.id","aggregatedcomment.tagged_users"]}}),a=r.data??{};e({type:"DELETE_COMMENT_MENTION",payload:{aggregatedCommentId:a.id,tagged_users:a.tagged_users}})},translateAggregatedComment:async t=>{try{let{resource_response:r}=await (0,u.Z)({url:`/v3/aggregated_comments/${t}/translate/`,method:"GET"}),a=r.data??"";e({type:"GET_COMMENT_TRANSLATION",payload:{aggregatedCommentId:t,translatedText:a}})}catch(r){e({type:"GET_COMMENT_TRANSLATION",payload:{aggregatedCommentId:t,translatedText:""}})}},toggleAggregatedCommentHelpful:({aggregatedCommentId:t,isMarkedHelpfulByMe:r,orbacSubjectId:a})=>{(0,u.Z)({url:`/v3/helpful/1/${t}/`,method:r?"DELETE":"POST",data:a?{orbac_subject_id:a}:{}}),e({type:"AGGREGATED_COMMENT_HELPFUL_TOGGLED",payload:{data:{id:t,marked_helpful_by_me:!r}}})},toggleAggregatedCommentHighlight:async({aggregatedCommentId:t,pinId:r,isHighlighted:a})=>{s()(t,"Could not find comment"),s()(r,"Could not find Pin"),await (0,u.Z)({url:"/v3/aggregated_comments/pin/highlight/",method:"PUT",data:{aggregated_comment:t,pin:r,highlight:!a}}),e({type:"AGGREGATED_COMMENT_HIGHLIGHT_TOGGLED",payload:{data:{aggregated_comment_id:t,pin_id:r,is_highlighted:!a}}})},toggleAggregatedCommentLike:({aggregatedCommentId:t,isLikedByMe:r,orbacSubjectId:a})=>{(0,u.Z)({url:`/v3/aggregated_comments/${t}/react/`,method:r?"DELETE":"POST",data:{reaction_type:1,...a?{orbac_subject_id:a}:{}}}),e({type:"AGGREGATED_COMMENT_LIKE_TOGGLED",payload:{data:{id:t,reaction_by_me:+!r}}})},updateAggregatedComment:async({commentId:t,force:r,orbacSubjectId:a,tags:n,text:o})=>{let{resource_response:s}=await l.Z.create("AggregatedCommentResource",{commentId:t,force:r,tags:n,text:o,...a?{orbacSubjectId:a}:{}}).callUpdate({showError:!1}),{tagged_users:i}=s.data??{};e({type:"AGGREGATED_COMMENT_UPDATED",payload:{data:{id:t,tagged_users:i.map(e=>({...e})),tags:JSON.parse(n),text:o}}})},updateAggregatedCommentFeatures:async({userId:t,featureMap:r,passcode:a,userConfirmPasscode:n})=>{let o={userId:t,featureMap:r,passcode:a,user_confirm_skip_passcode:n};void 0===n&&(o.user_confirm_skip_passcode=!1);let{resource_response:s}=await l.Z.create("AggregatedCommentFeaturesResource",o).callUpdate({showError:!1});e({type:"AGGREGATED_COMMENT_FEATURES_UPDATED",payload:{data:{featureMap:s.data??Object.freeze({})}}})},updateCommentCount:(t,r)=>{e({type:"UPDATE_AGGREGATED_COMMENT_COMMENT_COUNT",payload:{increment:r,id:t}})}}),[e])}function b(){let{aggregatedComments:e}=y();return e}},85442:function(e,t,r){r.d(t,{C:()=>n});var a=r(274320);function n(){let{checkExperiment:e}=(0,a.r)();switch(e("entrypoints_collage_wasm").group){case"prefetch_all":default:return{preloadExtent:"Both"};case"prefetch_only_js":return{preloadExtent:"OnlyJS"};case"control":return{preloadExtent:"None"}}}},393107:function(e,t,r){r.d(t,{Z:()=>s});var a=r(281098),n=r(821342),o=r(274320);let s=()=>{(0,a.Z)("useIsCollageOnDwebEnabled","/app/www/CollageCreation/useIsCollageOnDwebEnabled.tsx");let{checkExperiment:e}=(0,o.r)(),t=(0,n.Z)(),r=t.isAuth&&!t.isPartner;return (t=!1)=>{if(!r)return{anyEnabled:!1,followupFeatureEnabled:!1};let a=e("web_collage_creation",{dangerouslySkipActivation:t}),{anyEnabled:n}=a;return{anyEnabled:n,followupFeatureEnabled:a.group.startsWith("employee")||"enabled_followup_feature"===a.group}}}},598849:function(e,t,r){r.d(t,{C:()=>a,Z:()=>o});let{Provider:a,get:n}=(0,r(729434).Z)("Header"),o=n},469817:function(e,t,r){r.d(t,{Es:()=>u,HW:()=>i,er:()=>d,rQ:()=>c});var a=r(111330),n=r(753143),o=r(603316);let s=e=>e>=Date.now()-72e5,l=(e,t)=>{let r=[];if(e)for(let a of e)(!t||a.is_shared)&&s(a.ts)&&r.push(a);return r},i=()=>{let e=(0,n.M0)().getItem(a.uc)??[],t=l(e,!1),r=l(e,!0),o=t.map(e=>e.first_pin_image_signature),i=r.map(e=>e.first_pin_image_signature),u=(e=>{let t={};if(e)for(let r of e)r.is_shared&&s(r.ts)&&r.pin_id&&(t[r.pin_id]={inviteCode:r.pin_invite_code});return t})(e);return{extraPlpImages:o,plpImageRenderData:t,extraBlpImages:l((0,n.M0)().getItem(a.hI)??[],!0).map(e=>e.first_pin_image_signature),extraSharedImages:i,sharedPinData:u}},u=(e,t)=>{if(e.length!==t.length)return!1;for(let r=0;r<e.length;r+=1)if(e[r].id!==t[r].id)return!1;return!0},c=(e,t)=>e.map(e=>({1:e,2:(t[e]||[]).map(e=>({1:e,2:"pin"}))})),d=(e,t,r,a)=>{let n={};return e.forEach(e=>{let s=e.id,l=e.pins.length??0;n[s]=l,(0,o.QX)("webapp.log.nux.pin.picker.step.pin.number.of.pins",l,{sampleRate:1,addHostname:!0,tags:{appType:t,useCaseId:s,gender:r,age:a,use_case_display_name:e.display_name}}),(0,o.S0)("gauge.webapp.log.nux.pin.picker.step.pin.number.of.pins",l,{sampleRate:1,addHostname:!0,tags:{appType:t,useCaseId:s,gender:r,age:a,use_case_display_name:e.display_name}})}),n}},954300:function(e,t,r){r.d(t,{J:()=>o,f:()=>s});var a=r(782677),n=r(388023);let o=(e,{bookmark:t,options:r,schema:a})=>{let o=a||n.Z[e];return"function"==typeof o?o({resource:e,options:r,bookmark:t}):o};function s({data:e,opts:{bookmark:t,options:r,schema:n},resource:s}){let l=o(s,{bookmark:t,options:r,schema:n});return{normalizedResponse:l&&e?(0,a.Fv)(e,l):null,resourceSchema:l}}},979922:function(e,t,r){r.d(t,{BT:()=>Z,Du:()=>I,Fh:()=>U,HY:()=>L,HZ:()=>O,IY:()=>S,Jw:()=>y,Kp:()=>z,L7:()=>a,LT:()=>d,Lj:()=>H,Nw:()=>M,Q_:()=>A,Qc:()=>n,R5:()=>R,RA:()=>w,Tt:()=>k,UF:()=>u,UV:()=>s,VB:()=>C,W1:()=>o,Ws:()=>m,X5:()=>G,Yt:()=>N,ZW:()=>i,cK:()=>b,cy:()=>E,fA:()=>F,fn:()=>P,gm:()=>h,h7:()=>v,k:()=>f,mE:()=>x,o4:()=>_,oL:()=>j,qf:()=>p,tr:()=>c,uD:()=>T,uO:()=>g,vF:()=>l,wJ:()=>D});let a=1,n=2,o="female",s="male",l="unspecified",i="en-US",u="US",c=3,d="Welcome",m="Gender",p="CountryLocale",_="InterestPicker",f="UseCase",g="PinPicker",E="LoadingStep",y="AppInstall",h="NUX_PIN_PICKER_STEP_STATUS",C="NUX_USE_CASE_STEP_STATUS",b={NUX_GENDER_STEP_NAME:m,NUX_COUNTRY_LOCALE_STEP_NAME:p,NUX_INTEREST_PICKER_STEP_NAME:_,NUX_USE_CASE_STEP_NAME:f,NUX_PIN_PICKER_STEP_NAME:g,NUX_LOADING_STEP_NAME:E,NUX_APP_INSTALL_STEP_NAME:y},T=2,v=3,A=6,M=112,w=160,R=60,G=1e3,k=2500,U=1900,D=2e3,O=3,P=5,N=1,S=2,Z=3,L=3,I=5e3,j=250,F=1e10,H=507641,x=300,z=200},76086:function(e,t,r){r.d(t,{W:()=>c,u:()=>u}),r(281098);var a=r(667294),n=r(729434),o=r(979922);let s=(e,t)=>{let r=((e,t)=>{switch(t.type){case"SELECT_PIN":{let{pinData:r,pinId:a,useCaseId:n}=t.payload;return function({pinData:e,pinId:t,state:r,useCaseId:a}){let n=new Map(r.selectedUseCases),o=n.get(a)||{selectedPins:[],heroPin:null,backfillPins:[]},s={...e,pinId:t,selectedAt:Date.now()};return n.set(a,{...o,selectedPins:[...o.selectedPins,s]}),{...r,selectedUseCases:n}}({pinData:r,pinId:a,state:e,useCaseId:n})}case"DESELECT_PIN":{let{pinId:r,useCaseId:a}=t.payload;return function({pinId:e,state:t,useCaseId:r}){let a=new Map(t.selectedUseCases),n=a.get(r);return n&&a.set(r,{...n,selectedPins:n.selectedPins.filter(t=>t.pinId!==e)}),{...t,selectedUseCases:a}}({pinId:r,state:e,useCaseId:a})}case"SELECT_USE_CASE":{let{heroPin:r,useCaseId:a}=t.payload;return function({heroPin:e,state:t,useCaseId:r}){let a=new Map(t.selectedUseCases);return a.set(r,{selectedPins:[],heroPin:e,backfillPins:[]}),{...t,selectedUseCases:a}}({heroPin:r,state:e,useCaseId:a})}case"DESELECT_USE_CASE":{let{useCaseId:r}=t.payload;return function({state:e,useCaseId:t}){let r=new Map(e.selectedUseCases);return r.delete(t),{...e,selectedUseCases:r}}({state:e,useCaseId:r})}case"ADD_BACKFILL_PINS":{let{backfillPins:r,useCaseId:a}=t.payload;return function({backfillPins:e,state:t,useCaseId:r}){let a=new Map(t.selectedUseCases),n=a.get(r);return n&&a.set(r,{...n,backfillPins:[...e]}),{...t,selectedUseCases:a}}({backfillPins:r,state:e,useCaseId:a})}default:return e}})(e,t);return{...r,history:[...r.history||[],t]}};var l=r(785893);let{Provider:i,get:u}=(0,n.Z)("Nux");function c({children:e}){let[t,r]=(0,a.useState)([]),[n,u]=(0,a.useState)({}),[c,d]=(0,a.useState)(!1),m={selectedUseCases:new Map,history:[]},[p,_]=(0,a.useReducer)(s,m),f=(0,a.useCallback)(()=>Array.from(p.selectedUseCases.values()).reduce((e,t)=>e+t.selectedPins.length,0),[p.selectedUseCases]),g=(0,a.useCallback)(()=>Array.from(p.selectedUseCases.values()).reduce((e,t)=>e.concat(t.selectedPins),[]),[p.selectedUseCases]),E=(0,a.useCallback)(()=>g().map(e=>({url:e.imageMediumUrl,height:e.height,width:e.width})),[g]),y=(0,a.useCallback)(()=>{let e=[];for(let[t,r]of p.selectedUseCases){let a=r.selectedPins.map(e=>({1:e.pinId,2:"pin"}));e.push({1:t,2:a})}return e},[p.selectedUseCases]),h=(0,a.useCallback)(()=>p.selectedUseCases&&f()>=o.HZ,[f,p.selectedUseCases]),C=(0,a.useCallback)(()=>p.selectedUseCases.size>=o.Yt,[p.selectedUseCases]),b=(0,a.useMemo)(()=>({checkHasMetMinimumPinSelectionRequirement:h,checkHasMetMinimumUseCaseSelectionRequirement:C,getNuxSignals:y,getNumSelectedPins:f,getSelectedPinImageData:E,nuxSelectionsDispatch:_,nuxSelectionsState:p,selectedPins:n,selectedUseCases:t,setSelectedPins:u,setSelectedUseCases:r,setShouldUseNewReducerState:d,shouldUseNewReducerState:c}),[h,C,y,f,E,_,p,n,t,u,r,d,c]);return(0,l.jsx)(i,{value:b,children:e})}},261228:function(e,t,r){r.d(t,{H5:()=>i,Nq:()=>l,Q_:()=>u,bJ:()=>c});var a=r(575108),n=r(657043),o=r(600861),s=r(979922);function l(e){let{updateUserData:t}=e,r={},l=null;if(t.gender&&[s.W1,s.UV].includes(t.gender)?r.gender=t.gender:t.custom_gender&&(r.custom_gender=t.custom_gender,r.customGender=t.custom_gender,r.gender=s.vF),t.age?r.age=t.age:t.birthdate&&(r.birthdate=t.birthdate),t.locale&&(r.locale=t.locale),t.country&&(r.country=t.country),t.business_vertical&&(r.businessVertical=t.business_vertical),t.business_vertical_other&&(r.businessVerticalOther=t.business_vertical_other),t.number_employees&&(r.numberEmployees=t.number_employees),t.first_name&&(r.firstName=t.first_name),t.last_name&&(r.lastName=t.last_name),t.full_name&&(r.fullName=t.full_name),t.parent_email&&(r.parentEmail=t.parent_email),t.website_url&&(r.websiteUrl=t.website_url),t.listed_website_url&&(r.listedWebsiteUrl=t.listed_website_url),void 0!==t.allow_analytic_cookies&&(r.allow_analytic_cookies=t.allow_analytic_cookies),void 0!==t.allow_analytic_cookies&&(r.allow_marketing_cookies=t.allow_marketing_cookies),void 0!==t.allow_analytic_cookies&&(r.allow_personalization_cookies=t.allow_personalization_cookies),t.advertising_intent||t.business_name||t.account_type||t.business_goals||t.selected_ecommerce_platforms||t.enable_profile_message||t.enable_profile_address){let{account_type:e,advertising_intent:r,business_name:a,business_goals:n,enable_profile_message:o,enable_profile_address:s,selected_ecommerce_platforms:i}=t;l={...r?{advertising_intent:r}:{},...e?{account_type:e}:{},...a?{business_name:a}:{},...n?{business_goals:n}:{},...o?{enable_profile_message:o}:{},...s?{enable_profile_address:s}:{},...i?{selected_ecommerce_platforms:i}:{}}}l&&(r.partner=l,l.business_name&&(r.firstName=l.business_name));let i=a.Z.create("UserSettingsResource",{...t,surface_tag:o.i.NUX}).callUpdate();return async function(e){try{let t=await i;return e({type:"UPDATE_USER_SET",payload:r}),t}catch(e){return Promise.reject(Error((0,n.Z)(e,"message")))}}}function i(e){return{type:"UPDATE_USER_FIRST_HOME_FEED_REQUEST_AFTER_NUX",payload:e}}function u(e,t){return()=>{a.Z.create("UserStateResource",{state:e,value:t}).callCreate()}}function c(e,t=""){return()=>a.Z.create("UpdateFollowedInterestsResource",{referrer:t,updated_interest_follows:e}).callUpdate()}}}]);
//# sourceMappingURL=https://sm.pinimg.com/webapp/52176-b94f8f6f02be470a.mjs.map